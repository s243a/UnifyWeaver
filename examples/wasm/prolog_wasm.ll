; Generated by UnifyWeaver LLVM Target - WebAssembly
; Module: prolog_wasm
; Target: wasm32-unknown-unknown

source_filename = "prolog_wasm.ll"
target datalayout = "e-m:e-p:32:32-i64:64-n32:64-S128"
target triple = "wasm32-unknown-unknown"

; Function: sum/2 (tail recursion for WASM)
; Note: WASM uses i32 for most values

define i32 @sum_impl(i32 %n, i32 %acc) {
entry:
  %cmp = icmp sle i32 %n, 0
  br i1 %cmp, label %base, label %recurse
base:
  ret i32 %acc
recurse:
  %n1 = sub i32 %n, 1
  %acc1 = add i32 %acc, %n
  %result = tail call i32 @sum_impl(i32 %n1, i32 %acc1)
  ret i32 %result
}

; Exported wrapper
define i32 @sum(i32 %n) {
entry:
  %result = call i32 @sum_impl(i32 %n, i32 0)
  ret i32 %result
}


; Function: factorial (factorial for WASM)
define i32 @factorial(i32 %n) {
entry:
  %cmp = icmp sle i32 %n, 1
  br i1 %cmp, label %base, label %recurse
base:
  ret i32 1
recurse:
  %n1 = sub i32 %n, 1
  %sub = call i32 @factorial(i32 %n1)
  %res = mul i32 %n, %sub
  ret i32 %res
}

