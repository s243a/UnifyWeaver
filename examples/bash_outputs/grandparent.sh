#!/bin/bash
# Generated by UnifyWeaver test suite
# License: MIT OR Apache-2.0
# 
# This is an example output. When you use UnifyWeaver on your own code,
# your output is yours to license as you choose.
#
# grandparent - streaming pipeline with uniqueness

parent_join() {
    while IFS= read -r input; do
        IFS=":" read -r a b <<< "$input"
        for key in "${!parent_data[@]}"; do
            IFS=":" read -r c d <<< "$key"
            [[ "$b" == "$c" ]] && echo "$a:$d"
        done
    done
}

grandparent() {
    parent_stream | parent_join | sort -u
}

# Stream function for use in pipelines
grandparent_stream() {
    grandparent
}