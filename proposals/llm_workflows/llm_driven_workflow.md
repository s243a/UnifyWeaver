# Workflow: Economic Context Gathering

## Objective

This workflow details the process for an AI agent to intelligently gather context from a set of files by making an economic decision between several strategies.

## Step 1: Strategy Selection Logic

The core of this workflow is the logic for choosing the correct strategy. We need to formalize this logic into a Prolog predicate that can be compiled by the UnifyWeaver toolchain.

> [!generate-prolog]
> **Goal:** Create a Prolog predicate `choose_strategy/3`.
> 
> **Signature:** `choose_strategy(+FileCount, +Budget, -Strategy)`
> 
> **Logic:**
> 1. If `FileCount` is 1, the chosen `Strategy` is `single_file_precision`.
> 2. If `FileCount` is greater than 1 AND the estimated cost for the 'balanced' strategy is within the `Budget`, the `Strategy` is `balanced_deep_dive`.
> 3. Otherwise, the default `Strategy` is `quick_triage`.
> 
> **Assumptions:**
> - The cost of the 'balanced' strategy can be estimated as `$0.002 * FileCount`.

Below is the placeholder for the code you will generate.

```prolog
% Prolog code generated by the LLM agent will go here.

% Example of what the generated code might look like:
choose_strategy(1, _, single_file_precision).

choose_strategy(FileCount, Budget, balanced_deep_dive) :-
    FileCount > 1,
    EstimatedCost is 0.002 * FileCount,
    EstimatedCost =< Budget.

choose_strategy(FileCount, _, quick_triage) :-
    FileCount > 1.

```

## Step 2: Compilation

Once the Prolog code is generated, the next step is to use the UnifyWeaver compiler to transpile it into an executable bash script.

> [!unifyweaver-compile]
> **Predicate:** `choose_strategy/3`
> **Output:** `choose_strategy.sh`

This directive instructs the agent to take the previously generated Prolog code, save it to a temporary file, and then execute the UnifyWeaver `compiler_driver` on the `choose_strategy/3` predicate.
